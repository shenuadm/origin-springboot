# ===========================================
# 服务基础配置
# ===========================================
server:
  port: 8081

# ===========================================
# Spring 核心配置
# ===========================================
spring:
  application:
    name: "技术底座单体版"
  profiles:
    # 默认激活的环境
    active: dev
  servlet:
    multipart:
      # 限制单个上传文件的最大大小为 100MB
      max-file-size: 100MB
      # 限制整个上传请求的最大大小为 100MB（包括所有上传文件的大小之和）
      max-request-size: 100MB

# ===========================================
# JWT 认证配置
# ===========================================
jwt:
  # 签发人
  issuer: "一陌千尘"
  # 秘钥（建议使用环境变量或配置中心管理，如 ${JWT_SECRET}）
  secret: ${JWT_SECRET:HpOdsqmwOqtJcq3AzargcLbYKTp7qijmrPv4Mx9rLbGcS2mB0USGdmsPYJXso9zTVzWA/Tmrh/iW1irD8nYYTQ==}
  # token 过期时间（单位：分钟） 24*60
  tokenExpireTime: 1440
  # 记住我功能 token 过期时间（单位：分钟） 7*24*60
  rememberMeExpireTime: 10080
  # token 请求头中的 key 值
  tokenHeaderKey: Authorization
  # token 请求头中的 value 值前缀
  tokenPrefix: Bearer

# ===========================================
# 登录安全策略配置
# ===========================================
login:
  attempt:
    # 是否开启登录次数限制功能（true: 开启, false: 关闭）
    enabled: false
    # 最大失败次数，超过该次数将锁定账号（默认: 5）
    max-attempts: 5
    # 账号锁定时间（单位：分钟，默认: 30）
    lock-duration-minutes: 30
  session:
    # 登录策略配置：single-单设备登录（互踢），multiple-多设备登录（默认: multiple）
    strategy: multiple

# ===========================================
# 自定义组件配置（origin-framework）
# ===========================================
origin:
  # 事件驱动自定义线程池配置
  event:
    thread-pool:
      # 核心线程数，默认为 CPU 核心数
      core-pool-size: 4
      # 最大线程数，默认为 CPU 核心数的 2 倍
      max-pool-size: 8
      # 队列容量，默认为 200
      queue-capacity: 200
      # 线程空闲时间（秒），默认为 60 秒
      keep-alive-seconds: 60
      # 线程名前缀，默认为 "event-executor-"
      thread-name-prefix: "event-executor-"
      # 是否等待任务完成后再关闭线程池，默认为 true
      wait-for-tasks-to-complete-on-shutdown: true
      # 等待任务完成的超时时间（秒），默认为 60 秒
      await-termination-seconds: 60

  # 定时任务线程池配置
  scheduler:
    thread-pool:
      # 定时任务线程池大小
      pool-size: 5
      # 线程名前缀
      thread-name-prefix: "example-scheduler-"
      # 是否等待任务完成后再关闭线程池
      wait-for-tasks-to-complete-on-shutdown: true
      # 等待任务完成后再关闭线程池的超时时间（秒）
      await-termination-seconds: 60

  # 网关配置（限流、熔断、路由）
  gateway:
    enabled: true                           # 是否启用网关功能
    rate-limit:
      enabled: true                         # 是否启用限流
      default-limit: 100                    # 默认限流阈值（每秒请求数）
      time-window: 1                        # 限流时间窗口（秒）
      limit-message: "请求过于频繁，请稍后再试"   # 限流提示信息
      path-limits:                          # 特定接口限流配置
        /api/user/login: 10                 # 登录接口限流 10/s
        /api/user/register: 10              # 注册接口限流 10/s
        /api/order/create: 20               # 下单接口限流 20/s
    white-list:                             # 白名单路径
      - /health
      - /public
      - /swagger-ui
      - /v3/api-docs
    black-list: []                          # 黑名单（IP或用户ID）

# ===========================================
# API 文档配置（SpringDoc + Knife4j）
# ===========================================
springdoc:
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  api-docs:
    path: /v3/api-docs
  group-configs:
    - group: 'default'
      paths-to-match: '/**'
      packages-to-scan:
        # 指定扫描的包
        - com.cosmos.origin.admin.controller
        - com.cosmos.origin.websocket.controller
        - com.cosmos.origin.comment.controller

# ===========================================
# 评论功能配置
# ===========================================
comment:
  examine:
    # 是否开启评论审核功能（true: 开启, false: 关闭）
    open: false
  sensi:
    word:
      # 是否开启敏感词过滤功能（true: 开启, false: 关闭）
      open: false

# ===========================================
# Knife4j 增强配置
# ===========================================
knife4j:
  enable: true
  setting:
    language: zh_cn
